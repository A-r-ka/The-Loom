"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[4922],{7017:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"getting-started/architecture/overview","title":"Architecture Overview","description":"This page explains the high-level architecture of The Loom.","source":"@site/docs/getting-started/architecture/overview.md","sourceDirName":"getting-started/architecture","slug":"/getting-started/architecture/overview","permalink":"/the-loom/en/getting-started/architecture/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/a-r-ka/the-loom/tree/main/docs/docs/getting-started/architecture/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Configuration","permalink":"/the-loom/en/getting-started/configuration"},"next":{"title":"Frontend Architecture","permalink":"/the-loom/en/architecture/frontend"}}');var i=r(4848),s=r(8453);const l={},c="Architecture Overview",d={},a=[{value:"System Architecture",id:"system-architecture",level:2},{value:"Data Flow",id:"data-flow",level:2},{value:"Creating a Job",id:"creating-a-job",level:3},{value:"Tech Stack",id:"tech-stack",level:2},{value:"Frontend Layer",id:"frontend-layer",level:3},{value:"Backend Layer",id:"backend-layer",level:3},{value:"Blockchain Layer",id:"blockchain-layer",level:3},{value:"Worker Layer",id:"worker-layer",level:3},{value:"Database Schema",id:"database-schema",level:2},{value:"Schema Details",id:"schema-details",level:3},{value:"Smart Contract Architecture",id:"smart-contract-architecture",level:2},{value:"Security Considerations",id:"security-considerations",level:2},{value:"\u2705 Implemented",id:"-implemented",level:3},{value:"\ud83d\udea7 Future Improvements",id:"-future-improvements",level:3},{value:"Performance Metrics",id:"performance-metrics",level:2},{value:"Scalability",id:"scalability",level:2},{value:"Current Limits (MVP)",id:"current-limits-mvp",level:3},{value:"Future Scaling",id:"future-scaling",level:3},{value:"Next Steps",id:"next-steps",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"architecture-overview",children:"Architecture Overview"})}),"\n",(0,i.jsx)(n.p,{children:"This page explains the high-level architecture of The Loom."}),"\n",(0,i.jsx)(n.h2,{id:"system-architecture",children:"System Architecture"}),"\n",(0,i.jsx)(n.mermaid,{value:"graph TB\n    subgraph Client\n        A[Web Interface<br/>Next.js + React]\n        B[Wallet<br/>RainbowKit]\n    end\n    \n    subgraph Backend\n        C[API Routes<br/>Next.js API]\n        D[Database<br/>SQLite]\n        E[File Storage<br/>Local/IPFS]\n    end\n    \n    subgraph Blockchain\n        F[Smart Contract<br/>Scroll L2]\n        G[Chainlink<br/>Price Feeds]\n        H[Chainlink<br/>Automation]\n    end\n    \n    subgraph Workers\n        I[Worker Node<br/>Python Script]\n        J[GPU Compute<br/>PyTorch/CUDA]\n    end\n    \n    A --\x3e C\n    A --\x3e B\n    B --\x3e F\n    C --\x3e D\n    C --\x3e E\n    C --\x3e F\n    F --\x3e G\n    F --\x3e H\n    I --\x3e C\n    I --\x3e J\n    I --\x3e F"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"data-flow",children:"Data Flow"}),"\n",(0,i.jsx)(n.h3,{id:"creating-a-job",children:"Creating a Job"}),"\n",(0,i.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant API\n    participant DB\n    participant Contract\n    participant Worker\n    \n    Client->>API: POST /api/projects\n    API->>DB: INSERT project\n    DB--\x3e>API: Project ID\n    API--\x3e>Client: Success\n    \n    Client->>Contract: createJob(projectId)\n    Contract->>Contract: Lock payment in escrow\n    Contract--\x3e>Client: Transaction confirmed\n    \n    Worker->>API: GET /api/projects (polling)\n    API->>DB: SELECT pending jobs\n    DB--\x3e>API: Available jobs\n    API--\x3e>Worker: Job list\n    \n    Worker->>Contract: claimJob(projectId)\n    Contract->>Contract: Assign worker\n    Contract--\x3e>Worker: Claim confirmed\n    \n    Worker->>Worker: Execute script\n    Worker->>API: PUT /api/projects/:id\n    API->>DB: UPDATE status=COMPLETED\n    \n    Worker->>Contract: completeJob(projectId)\n    Contract->>Contract: Release payment\n    Contract--\x3e>Worker: Payment sent \u2705"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"tech-stack",children:"Tech Stack"}),"\n",(0,i.jsx)(n.h3,{id:"frontend-layer",children:"Frontend Layer"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Technology"}),(0,i.jsx)(n.th,{children:"Purpose"}),(0,i.jsx)(n.th,{children:"Why"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Next.js 14"})}),(0,i.jsx)(n.td,{children:"Framework"}),(0,i.jsx)(n.td,{children:"SSR, API routes, file routing"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"React 18"})}),(0,i.jsx)(n.td,{children:"UI Library"}),(0,i.jsx)(n.td,{children:"Component-based, hooks"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"TailwindCSS"})}),(0,i.jsx)(n.td,{children:"Styling"}),(0,i.jsx)(n.td,{children:"Utility-first, responsive"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"RainbowKit"})}),(0,i.jsx)(n.td,{children:"Web3 UI"}),(0,i.jsx)(n.td,{children:"Pre-built wallet connection"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"wagmi"})}),(0,i.jsx)(n.td,{children:"Web3 Hooks"}),(0,i.jsx)(n.td,{children:"React hooks for Ethereum"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"TanStack Query"})}),(0,i.jsx)(n.td,{children:"Data Fetching"}),(0,i.jsx)(n.td,{children:"Caching, automatic refetch"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"backend-layer",children:"Backend Layer"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Technology"}),(0,i.jsx)(n.th,{children:"Purpose"}),(0,i.jsx)(n.th,{children:"Why"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Next.js API Routes"})}),(0,i.jsx)(n.td,{children:"REST API"}),(0,i.jsx)(n.td,{children:"Same codebase as frontend"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"SQLite"})}),(0,i.jsx)(n.td,{children:"Database"}),(0,i.jsx)(n.td,{children:"Simple, file-based, no setup"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"FormData API"})}),(0,i.jsx)(n.td,{children:"File Upload"}),(0,i.jsx)(n.td,{children:"Handle script uploads"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"blockchain-layer",children:"Blockchain Layer"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Technology"}),(0,i.jsx)(n.th,{children:"Purpose"}),(0,i.jsx)(n.th,{children:"Why"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Solidity 0.8.20"})}),(0,i.jsx)(n.td,{children:"Smart Contracts"}),(0,i.jsx)(n.td,{children:"Industry standard"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Scroll L2"})}),(0,i.jsx)(n.td,{children:"Deployment Network"}),(0,i.jsx)(n.td,{children:"Low fees, EVM-compatible"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Chainlink Price Feeds"})}),(0,i.jsx)(n.td,{children:"USD\u2192ETH Conversion"}),(0,i.jsx)(n.td,{children:"Decentralized oracles"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Chainlink Automation"})}),(0,i.jsx)(n.td,{children:"Auto-release Payments"}),(0,i.jsx)(n.td,{children:"Keeper network"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"worker-layer",children:"Worker Layer"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Technology"}),(0,i.jsx)(n.th,{children:"Purpose"}),(0,i.jsx)(n.th,{children:"Why"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Python 3.10+"})}),(0,i.jsx)(n.td,{children:"Worker Script"}),(0,i.jsx)(n.td,{children:"ML/AI ecosystem"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"PyTorch"})}),(0,i.jsx)(n.td,{children:"AI Training"}),(0,i.jsx)(n.td,{children:"Most popular ML framework"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"CUDA"})}),(0,i.jsx)(n.td,{children:"GPU Acceleration"}),(0,i.jsx)(n.td,{children:"NVIDIA GPU support"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"database-schema",children:"Database Schema"}),"\n",(0,i.jsx)(n.mermaid,{value:'erDiagram\n    PROJECTS {\n        int id PK\n        string title\n        string description\n        enum type "IA or GRAFICA"\n        float price\n        string wallet_address\n        enum status "PENDING, WORKING, COMPLETED"\n        int progress\n        datetime created_at\n        string cloud_link\n        string script_path\n        json external_links\n        string attachment_info\n        string worker_address\n    }'}),"\n",(0,i.jsx)(n.h3,{id:"schema-details",children:"Schema Details"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE projects (\n  id INTEGER PRIMARY KEY AUTOINCREMENT,\n  title TEXT NOT NULL,\n  description TEXT,\n  type TEXT CHECK(type IN ('IA', 'GRAFICA')),\n  price REAL NOT NULL,\n  wallet_address TEXT,\n  status TEXT DEFAULT 'PENDING',\n  progress INTEGER DEFAULT 0,\n  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n  cloud_link TEXT,\n  script_path TEXT,\n  external_links TEXT, -- JSON array\n  attachment_info TEXT,\n  worker_address TEXT\n);\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"smart-contract-architecture",children:"Smart Contract Architecture"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-solidity",children:"contract TheLoomEscrow {\n    struct Job {\n        address client;      // Who posted the job\n        uint256 payment;     // Amount locked\n        address worker;      // Who claimed it\n        bool completed;      // Completion status\n        uint256 deadline;    // Timeout (7 days)\n    }\n    \n    mapping(uint256 => Job) public jobs;\n    \n    // Client deposits payment\n    function createJob(uint256 jobId) external payable;\n    \n    // Worker claims job\n    function claimJob(uint256 jobId) external;\n    \n    // Worker marks as done\n    function completeJob(uint256 jobId) external;\n    \n    // Auto-refund if timeout\n    function refundExpired(uint256 jobId) external;\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,i.jsx)(n.h3,{id:"-implemented",children:"\u2705 Implemented"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Escrow Pattern"}),": Payments locked until completion"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Wallet Validation"}),": Ethereum address format check"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"SQL Injection Protection"}),": Parameterized queries"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"File Upload Sanitization"}),": Filename cleaning"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-future-improvements",children:"\ud83d\udea7 Future Improvements"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\ud83d\udea7 ",(0,i.jsx)(n.strong,{children:"Proof of Work"}),": Verify computation actually happened"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83d\udea7 ",(0,i.jsx)(n.strong,{children:"Script Sandboxing"}),": Docker containers for security"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83d\udea7 ",(0,i.jsx)(n.strong,{children:"Reputation System"}),": NFT badges for reliable workers"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83d\udea7 ",(0,i.jsx)(n.strong,{children:"Dispute Resolution"}),": Oracle-based arbitration"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"performance-metrics",children:"Performance Metrics"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Operation"}),(0,i.jsx)(n.th,{children:"Time"}),(0,i.jsx)(n.th,{children:"Cost"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Create Job (DB)"}),(0,i.jsx)(n.td,{children:"~50ms"}),(0,i.jsx)(n.td,{children:"Free"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Create Job (Blockchain)"}),(0,i.jsx)(n.td,{children:"~2-5s"}),(0,i.jsx)(n.td,{children:"~$0.01 (Scroll L2)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Claim Job"}),(0,i.jsx)(n.td,{children:"~2s"}),(0,i.jsx)(n.td,{children:"~$0.005"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Complete Job"}),(0,i.jsx)(n.td,{children:"~3s"}),(0,i.jsx)(n.td,{children:"~$0.01"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Worker Poll Interval"}),(0,i.jsx)(n.td,{children:"10s"}),(0,i.jsx)(n.td,{children:"N/A"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"scalability",children:"Scalability"}),"\n",(0,i.jsx)(n.h3,{id:"current-limits-mvp",children:"Current Limits (MVP)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Jobs"}),": Unlimited (SQLite can handle 140TB)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"File Size"}),": 100MB max upload"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Concurrent Workers"}),": 10-20 (polling bottleneck)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Transactions/sec"}),": ~10 (Scroll L2 limit)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"future-scaling",children:"Future Scaling"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"IPFS"}),": Decentralized file storage"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"PostgreSQL"}),": Production-grade database"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"WebSockets"}),": Real-time job updates"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Zk-Rollups"}),": Higher TPS on Layer 2"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/architecture/frontend",children:"Frontend Architecture \u2192"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/smart-contracts/overview",children:"Smart Contract Details \u2192"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/api/overview",children:"API Reference \u2192"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>c});var t=r(6540);const i={},s=t.createContext(i);function l(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);